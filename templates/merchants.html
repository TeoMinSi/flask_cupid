<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="shortcut icon" type="image/x-icon" href="/dist/img/favicon.ico" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MarTechX - Data Analytics Platform</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
  <!-- daterange picker -->
  <link rel="stylesheet" href="/plugins/daterangepicker/daterangepicker.css">
  <!-- iCheck for checkboxes and radio inputs -->
  <link rel="stylesheet" href="/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
  <!-- Bootstrap Color Picker -->
  <link rel="stylesheet" href="/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css">
  <!-- Tempusdominus Bootstrap 4 -->
  <link rel="stylesheet" href="/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
  <!-- Select2 -->
  <link rel="stylesheet" href="/plugins/select2/css/select2.min.css">
  <link rel="stylesheet" href="/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css">
  <!-- Bootstrap4 Duallistbox -->
  <link rel="stylesheet" href="/plugins/bootstrap4-duallistbox/bootstrap-duallistbox.min.css">
  <!-- BS Stepper -->
  <link rel="stylesheet" href="/plugins/bs-stepper/css/bs-stepper.min.css">
  <!-- dropzonejs -->
  <link rel="stylesheet" href="/plugins/dropzone/min/dropzone.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="/dist/css/adminlte.min.css">

  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <style>
  .btns{
    margin-top:10px;
    display:inline-block;
    width:20%;
  }
  
  .loading {
    width: 100%;
    height: 100%;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: rgba(0,0,0,.5);
}
.loading-wheel {
    width: 50px;
    height: 50px;
    margin-top: -40px;
    margin-left: -40px;
    
    position: absolute;
    top: 50%;
    left: 60%;
    
    border-width: 30px;
    border-radius: 50%;
    -webkit-animation: spin 1s linear infinite;
}

#loadingText {
    width: 300px;
    height: 300px;
    margin-top: -40px;
    margin-left: -40px;
    
    position: absolute;
    top: 60%;
    left: 53%;
    
    border-width: 30px;
    border-radius: 50%;

    color:aqua;
    font-weight:bold;
}

.style-2 .loading-wheel {
    border-style: double;
    border-color: #ccc transparent;
}
@-webkit-keyframes spin {
    0% {
        -webkit-transform: rotate(0);
    }
    100% {
        -webkit-transform: rotate(-360deg);
    }
}

#loadingScreen{
  display:none;
}
  </style>

</head>
<body class="hold-transition sidebar-mini layout-fixed">
    <div class="wrapper">
    
      <!-- Navbar -->
      <nav class="main-header navbar navbar-expand navbar-white navbar-light">
        <!-- Left navbar links -->
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
          </li>
          <!-- <li class="nav-item d-none d-sm-inline-block">
            <a href="index3.html" class="nav-link">Home</a>
          </li> -->
          <!-- <li class="nav-item d-none d-sm-inline-block">
            <a href="#" class="nav-link">Contact</a>
          </li> -->
        </ul>
    
        <!-- SEARCH FORM -->
        <form class="form-inline ml-3">
          <div class="input-group input-group-sm">
            <input class="form-control form-control-navbar" type="search" placeholder="Search" aria-label="Search">
            <div class="input-group-append">
              <button class="btn btn-navbar" type="submit">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
        </form>
    
        <!-- Right navbar links -->
        <ul class="navbar-nav ml-auto">
          <!-- Messages Dropdown Menu -->
          <li class="nav-item dropdown">
            <a class="nav-link" data-toggle="dropdown" href="#">
              <i class="far fa-comments"></i>
              <span class="badge badge-danger navbar-badge">3</span>
            </a>
            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
              <a href="#" class="dropdown-item">
                <!-- Message Start -->
                <div class="media">
                  <!-- <img src="/dist/img/user1-128x128.jpg" alt="User Avatar" class="img-size-50 mr-3 img-circle"> -->
                  <div class="media-body">
                    <h3 class="dropdown-item-title">
                      Brad Diesel
                      <span class="float-right text-sm text-danger"><i class="fas fa-star"></i></span>
                    </h3>
                    <p class="text-sm">Call me whenever you can...</p>
                    <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
                  </div>
                </div>
                <!-- Message End -->
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <!-- Message Start -->
                <div class="media">
                  <!-- <img src="/dist/img/user8-128x128.jpg" alt="User Avatar" class="img-size-50 img-circle mr-3"> -->
                  <div class="media-body">
                    <h3 class="dropdown-item-title">
                      John Pierce
                      <span class="float-right text-sm text-muted"><i class="fas fa-star"></i></span>
                    </h3>
                    <p class="text-sm">I got your message bro</p>
                    <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
                  </div>
                </div>
                <!-- Message End -->
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <!-- Message Start -->
                <div class="media">
                  <!-- <img src="/dist/img/user3-128x128.jpg" alt="User Avatar" class="img-size-50 img-circle mr-3"> -->
                  <div class="media-body">
                    <h3 class="dropdown-item-title">
                      Nora Silvester
                      <span class="float-right text-sm text-warning"><i class="fas fa-star"></i></span>
                    </h3>
                    <p class="text-sm">The subject goes here</p>
                    <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
                  </div>
                </div>
                <!-- Message End -->
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item dropdown-footer">See All Messages</a>
            </div>
          </li>
          <!-- Notifications Dropdown Menu -->
          <li class="nav-item dropdown">
            <a class="nav-link" data-toggle="dropdown" href="#">
              <i class="far fa-bell"></i>
              <span class="badge badge-warning navbar-badge">15</span>
            </a>
            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
              <span class="dropdown-item dropdown-header">15 Notifications</span>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-envelope mr-2"></i> 4 new messages
                <span class="float-right text-muted text-sm">3 mins</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-users mr-2"></i> 8 friend requests
                <span class="float-right text-muted text-sm">12 hours</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-file mr-2"></i> 3 new reports
                <span class="float-right text-muted text-sm">2 days</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-widget="fullscreen" href="#" role="button">
              <i class="fas fa-expand-arrows-alt"></i>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#" role="button">
              <i class="fas fa-th-large"></i>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.navbar -->
    
      <!-- Main Sidebar Container -->
      <aside class="main-sidebar sidebar-dark-primary elevation-4" style="background-color:#fff;"> 
        <!-- Brand Logo -->
        <a href="/index.html" class="brand-link">
          <img src="/dist/img/logo2.png" alt="AdminLTE Logo" style="
          height: 67px;
          opacity: .8;
          position: relative;
          right: -25px;" >
          <!-- <span class="brand-text font-weight-light">CitiBank</span> -->
        </a>
    
        <!-- Sidebar -->
        <div class="sidebar">

    
          <!-- Sidebar Menu -->
          <nav class="mt-2">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
            
             
              <li class="nav-item">
                <a href="/index.html" class="nav-link sideMenuPages">
                    <i class="nav-icon fas fa-tachometer-alt"></i>
                    <p style="font-weight: bold;">
                      Customer Dashboard
                    </p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/flask/templates/merchants.html" class="nav-link sideMenuPages">
                  <!-- change icon here-->
                  <!-- <i class="nav-icon far fa-image"></i> -->
                  <i class="nav-icon fas fa-users"></i>
                  <p style="font-weight: bold;">
                    Merchants Analysis
                  </p>
                </a>
              </li>
    
    
              <li class="nav-item">
                <a href="/flask/templates/inputData.html" class="nav-link sideMenuPages">
                  <!-- change icon here-->
                  <!-- <i class="nav-icon far fa-image"></i> -->
                  &nbsp;&nbsp;<i class="fab fa-wpforms"></i>
                  <p style="font-weight: bold;">
                    &nbsp;&nbsp;&nbsp;Upload Data
                  </p>
                </a>
              </li>
    
              <li class="nav-item">
                <a href="/flask/templates/predictionForm.html" class="nav-link sideMenuPages">
                  <!-- change icon here-->
                  <!-- <i class="nav-icon far fa-image"></i> -->
                  &nbsp;&nbsp;<i class="fab fa-wpforms"></i>
                  <p style="font-weight: bold;">
                    &nbsp;&nbsp;&nbsp;Data Prediction Form
                  </p>
                </a>
              </li>
    
              <li class="nav-item">
                <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle nav-link">
                  <i class="nav-icon far fas fa-database"></i>
                  <p style="font-weight: bold;">
                    Data Tables
                  </p>
                </a>
                <ul class="collapse list-unstyled  nav" id="pageSubmenu">
    
                  <li class="nav-item">
                    <a href="/flask/templates/cleanRawDataTable.html" class="nav-link sideMenuPages" style="right:-15px !important;">
                      <i class="fas fa-table"></i>
                      <p style="font-size: 12px; font-weight:bold;">
                        Cleaned Raw Data Table
                      </p>
                    </a>
                  </li>
    
                    <li class="nav-item">
                        <a href="/flask/templates/customerDataTable.html" class="nav-link sideMenuPages" style="right:-15px !important;">
                          <i class="fas fa-table"></i>
                          <p style="font-size: 12px; font-weight:bold;">
                            Customer Data Table
                          </p>
                        </a>
                    </li>
    
                    <li class="nav-item">
                      <a href="/flask/templates/merchantFrequencyDataTable.html" class="nav-link sideMenuPages" style="right:-15px !important;">
                        <i class="fas fa-table"></i>
                        <p style="font-size: 12px; font-weight:bold;">
                          Merchant Frequency Data Table
                        </p>
                      </a>
                    </li>
    
                    <li class="nav-item">
                      <a href="/flask/templates/merchantScoreDataTable.html" class="nav-link sideMenuPages" style="right:-15px !important;">
                        <i class="fas fa-table"></i>
                        <p style="font-size: 12px; font-weight:bold;">
                          Merchant Score Data Table
                        </p>
                      </a>
                    </li>
                    <li class="nav-item">
                      <a href="/flask/templates/mbaDataTable.html" class="nav-link sideMenuPages" style="right:-15px !important;">
                        <i class="fas fa-table"></i>
                        <p style="font-size: 12px; font-weight:bold;">
                          Market Basket Analysis Data Table
                        </p>
                      </a>
                    </li>
                </ul>
            </li>
    
    
              <li class="nav-item">
                <a href="/flask/templates/help.html" class="nav-link sideMenuPages">
                  <i class="nav-icon fas fa-question"></i>
                  <p style="font-weight: bold;">
                    Help
                  </p>
                </a>
              </li>
              
          </nav>
          <!-- /.sidebar-menu -->
        </div>
        <!-- /.sidebar -->
      </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header" style="padding-bottom: 0px;">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0 text-dark" id="pageTitle">Merchants Analysis</h1>
            
            <br/>

            <div class="btn-group">
              <button type="button" style="width:150px; right:-25px;" class="btn btn-info btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Run Analysis
              </button>
              <div class="dropdown-menu">
                <button class="dropdown-item" style="width:150px; font-size:12px;" id="sentimentAnalysisBtn" type="button">Sentiment Analysis</button>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item" style="width:150px; font-size:12px;" id="mbaBtn" type="button">Market Basket Analysis</button>
              </div>
            </div>
          
            <div id="loadingScreen">
              <div class="loading style-2"><div class="loading-wheel"></div><p id="loadingText">Loading.. Please wait for a few minutes..</p></div>
            </div>

          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item">Home</li>
              <li class="breadcrumb-item active">Merchants Analysis</li>
            </ol>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <div class="content">
      <div class="container-fluid">
        <div class="row">
          <p class="card-title" style="margin: 0 auto; display:block; width:95%; font-size: 15px;font-style: italic; color:#6c757d;">Right click to drill through the Dashboard</p>
          <iframe style="margin: 0 auto; display:block;"   width="1100" height="640" src="https://app.powerbi.com/reportEmbed?reportId=7e962b00-cb16-40ce-a555-fc286c153047&autoAuth=true&ctid=c98a79ca-5a9a-4791-a243-f06afd67464d&config=eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly93YWJpLXNvdXRoLWVhc3QtYXNpYS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldC8ifQ%3D%3D" frameborder="0" allowFullScreen="true"></iframe>
          <!-- <iframe  width="1050" height="550" src="https://app.powerbi.com/reportEmbed?reportId=7e962b00-cb16-40ce-a555-fc286c153047&autoAuth=true&ctid=c98a79ca-5a9a-4791-a243-f06afd67464d&config=eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly93YWJpLXNvdXRoLWVhc3QtYXNpYS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldC8ifQ%3D%3D" frameborder="0" allowFullScreen="true"></iframe> -->
          <p class="card-title" style="margin: 0 auto; display:block; width:95%;" id="lastUploaded"></p>
          
        </div>
        <!-- /.row -->
      </div>
      <!-- /.container-fluid -->
    </div>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->

  <!-- Main Footer -->
  <footer class="main-footer">
    <strong>Copyright &copy; 2020 <a style="color:#0DCED7" href="/index.html">MarTechX</a>.</strong> All rights reserved.
    All rights reserved.
    <div class="float-right d-none d-sm-inline-block">
      <b>Version</b> 3.1.0-pre
    </div>
  </footer>
</div>
<!-- ./wrapper -->

<!-- REQUIRED SCRIPTS -->

<!-- jQuery -->
<script src="/plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- AdminLTE -->
<script src="/dist/js/adminlte.js"></script>

<!-- OPTIONAL SCRIPTS -->
<!-- <script src="/plugins/chart.js/Chart.min.js"></script> -->
<!-- AdminLTE for demo purposes -->
<script src="/dist/js/demo.js"></script>
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<!-- <script src="/dist/js/pages/dashboard3.js"></script> -->

<script>

localStorage.setItem("pageTitle", document.getElementById("pageTitle").innerText);

  
  pageSelected = document.getElementsByClassName("sideMenuPages")
  for (let i=0; i<pageSelected.length; i++){
    let pageName = pageSelected[i].innerText
    pageName = pageName.trim()
    let currentPage = localStorage.getItem("pageTitle");
    if (currentPage == pageName){
      document.getElementsByClassName("sideMenuPages")[i].style.color = "#0DCED7";
    }
  }

document.addEventListener('DOMContentLoaded', function() {
  runSA()
  runMBA()
}, false);
            
function runSA(){
  const Url = 'https://flaskcupid.herokuapp.com/merchant'
  $('#sentimentAnalysisBtn').click(function(){
  console.log("clicked")

  $.ajax({
    url:Url,
    type:"POST",
    beforeSend: function(){
              console.log("beforesend")
                $('#loadingScreen').show();
    },
    complete: function(){
      $('#loadingScreen').hide();
    },
    success:function(result){
      alert("Sentiment Analysis Completed!")
      console.log("Sentiment Analysis RESULT IS: ", result)
    },
    error:function(error){
      alert("Error! Sentiment Analysis Ran Unsuccessfully! Please try again later.")
      console.log(`Error ${error}`)
      location.reload();
      return false;
    }
  })
  })
}

function runMBA(){
  const Url = 'https://flaskcupid.herokuapp.com/mba'
  $('#mbaBtn').click(function(){
  console.log("clicked")

  $.ajax({
    url:Url,
    type:"POST",
    beforeSend: function(){
              console.log("beforesend")
                $('#loadingScreen').show();
    },
    complete: function(){
      $('#loadingScreen').hide();
    },
    success:function(result){
      alert("Market Basket Analysis Completed!")
      console.log("mba RESULT IS: ", result)
      
    },
    error:function(error){
      alert("Error! Market Basket Analysis Ran Unsuccessfully. Please try again later.")
      console.log(`Error ${error}`)
    }
  })
  })
}

            document.addEventListener('DOMContentLoaded', function() {
              let lastUploadedDT = "-"
                if (localStorage.getItem("lastUploadedDT") != null){
                  lastUploadedDT = localStorage.getItem("lastUploadedDT")
                }
                document.getElementById("lastUploaded").innerHTML = "Last Updated: " + lastUploadedDT
                document.getElementById("lastUploaded").style.color = "#6c757d"
                document.getElementById("lastUploaded").style.fontSize = "14px"
                document.getElementById("lastUploaded").style.fontStyle = "italic"
            }, false);
    


</script>
</body>
</html>
